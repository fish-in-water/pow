(function(a){var b=a.POW;b.Chart.Doughnut=function(a,c,d){b.Chart.Core.call(this,a,c,d)},b.Chart.Core.prototype._inheritPrototype(b.Chart.Doughnut,b.Chart.Core);var c=b.Chart.Doughnut.prototype;c._DEFAULT={chart:{doughnutRadius:"",doughnutThickness:"30",doughnutPadding:"20",startingAngle:"0",legendAngle:"0",legendPadding:"0",plotBorderThickness:"1.5",plotBorderColor:"FF0000",plotBorderAlpha:"0",plotFillAlpha:"30",plotBorderDashed:"0",plotBorderDashedStyle:"0",plotPadding:"10",seriesNameInToolTip:"1",dataValueInToolTip:"1",percentInToolTip:"1",showValueLabel:"1",valueLabelPadding:"5",seriesNameInValueLabel:"1",dataValueInValueLabel:"1",percentInValueLabel:"1",valueLabelSepChar:", ",valueLabelOutside:"1",showLabelLine:"1",labelLineSlanted:"1",labelLinePadding:"2",labelLineClearance:"15",labelLineDistance:"10",labelLineColor:"545454",labelLineThickness:"1",labelLineAlpha:"100",labelLineDashed:"0",labelLineDashedStyle:"-",dataset:[{seriesName:"",startingAngle:"",fillColor:"",fillAlpha:"",borderColor:"",borderAlpha:"",borderDashed:"",borderDashedStyle:"",set:[{label:"",value:"0",displayValue:"",toolText:"",fillColor:"",fillAlpha:"",borderColor:"",borderAlpha:"",borderDashed:"",borderDashedStyle:""}]}]}},b.Chart.Core.prototype._extendObject(c._DEFAULT,b.Chart.Core.prototype._DEFAULT),b.Chart.Core.prototype._extendObject(c._RESOURCE,b.Chart.Core.prototype._RESOURCE),b.Chart.Core.prototype._extendObject(c._CONST,b.Chart.Core.prototype._CONST),c.setData=function(a){this._setDefault(a),this._adjustData(a),this._initBBox(a),this._drawBase(a),this._drawDoughnut(a)},c._getDataByUrl=function(a){var b=this._loadXmlUrl(a),c=this._tranXml2Object(b);return this._setDefault(c),this._adjustData(c),c},c._setDefault=function(a){this._standardizeObject(a,this._DEFAULT.chart)},c._adjustData=function(a){a.showLegend4Doughnut=a.showLegend,a.showLegend=this._CONST.DISABLE},c._drawDoughnut=function(a){this._setPatternInfo(a),this._createPatternPlot(a),this._createSeriesName(a)},c._createSeriesName=function(a){var b=a.dataset;if(!b)return null;var c=a.showLegend4Doughnut;if(this._CONST.ENABLE===c)for(var d=this._getCanvasBBox(a),e=Math.floor((d.x+d.x2)/2),f=Math.floor((d.y+d.y2)/2),g=Math.floor(a.legendAngle-0)%360,h=Math.floor(a.legendPadding-0),i=this._getFontStyle(a,this._CONST.STYLEOBJECT.LEGEND),j=0,k=b.length;j<k;j++){var l=b[j].radius,m=b[j].thickness,n=b[j].seriesName;if(n){var o=e+(l-m/2+h)*Math.sin(g/180*Math.PI),p=f-(l-m/2+h)*Math.cos(g/180*Math.PI);Raphael.vml&&(o+=1,p+=2),this._createText({text:n,cx:o,cy:p,"font-family":i.font,"font-size":i.size,"font-color":i.color,"font-weight":i.bold})}}},c._createPatternPlot=function(a){var b=a.dataset;if(!b)return null;for(var c=a.plotBorderThickness-0,d=a.plotBorderColor,e=Math.floor(a.plotBorderAlpha-0)/100,f=a.plotBorderDashed,g=a.plotBorderDashedStyle,h=(Math.floor(a.plotFillAlpha-0),Math.floor(a.plotPadding-0),this._getCanvasBBox(a)),i=Math.floor((h.x+h.x2)/2),j=Math.floor((h.y+h.y2)/2),k=0,l=b.length;k<l;k++)for(var m=b[k].set,n=b[k].radius,o=b[k].thickness,p=0,q=m.length;p<q;p++){var r=m[p],s=r.startAngle,t=r.endAngle,u=r.fillColor||b[k].fillColor,v=Math.floor((r.fillAlpha||b[k].fillAlpha||e)-0)/100,w=r.borderColor||b[k].borderColor||d,x=r.borderAlpha||b[k].borderAlpha||e,y=r.borderDashed||b[k].borderDashed||f,z=this._CONST.ENABLE===y?r.borderDashedStyle||b[k].borderDashedStyle||g:"",A=0,B=0;0===c&&(A=0-1*Math.sin((s+t)/2/180*Math.PI),B=1*Math.cos((s+t)/2/180*Math.PI));var C=this._createCake({cx:i,cy:j,dx:A,dy:B,radius:n,thickness:o,"start-angle":s,"end-angle":t,stroke:w,"stroke-width":c,"stroke-opacity":x,"stroke-dasharray":z,fill:u,"fill-opacity":v});C.node["click-data"]=r.click,C.node["mouseover-data"]=r.mouseover,C.node["mousemove-data"]=r.mousemove,C.node["mouseout-data"]=r.mouseout,C.node["tooltip-data"]=r.toolTip}for(var k=0,l=b.length;k<l;k++)for(var D=b[k],m=D.set,n=D.radius,o=D.thickness,u=D.fillColor,p=0,q=m.length;p<q;p++){var r=m[p],s=r.startAngle,t=r.endAngle,A=0,B=0;0===c&&(A=0-1*Math.sin((s+t)/2/180*Math.PI),B=1*Math.cos((s+t)/2/180*Math.PI));var E=this._createCake({cx:i,cy:j,dx:A,dy:B,radius:n,thickness:o,"start-angle":s,"end-angle":t,stroke:"#FFFFFF","stroke-width":0,"stroke-opacity":0,fill:"#FFFFFF","fill-opacity":0});E.node["click-data"]=r.click,E.node["mouseover-data"]=r.mouseover,E.node["mousemove-data"]=r.mousemove,E.node["mouseout-data"]=r.mouseout,E.node["tooltip-data"]=r.toolTip}var F=a.showValueLabel;if(this._CONST.ENABLE===F)for(var h=this._getCanvasBBox(a),G=(h.x+h.x2)/2,H=(h.y+h.y2)/2,I=this._getFontStyle(a,this._CONST.STYLEOBJECT.VALUELABEL),J=a.showLabelLine,K=a.labelLineSlanted,L=a.valueLabelOutside,M=Math.floor(a.labelLinePadding-0),N=Math.floor(a.labelLineClearance-0),O=Math.floor(a.labelLineDistance-0),P=a.labelLineColor,Q=Math.floor(a.labelLineThickness-0),R=Math.floor(a.labelLineAlpha-0)/100,S=this._CONST.ENABLE===a.labelLineDashed?a.labelLineDashedStyle:"",T=Math.floor(a.valueLabelPadding-0),k=0,l=b.length;k<l;k++)for(var m=b[k].set,n=b[k].radius,p=0,q=m.length;p<q;p++){var U=N;this._CONST.ENABLE===L&&(U+=b[0].radius-b[k].radius);var r=m[p],V=this._createRadiantLabel({cx:G,cy:H,radius:n,angle:r.middleAngle,label:r.valueLabel,"label-padding":T,"font-family":I.font,"font-size":I.size,"font-color":I.color,"font-weight":I.bold,"show-line":J,"line-slanted":K,"line-padding":M,"line-clearance":U,"line-distance":O,"line-color":P,"line-thickness":Q,"line-alpha":R,"line-dashed-style":S});V["click-data"]=r.click,V["mouseover-data"]=r.mouseover,V["mousemove-data"]=r.mousemove,V["mouseout-data"]=r.mouseout,V["tooltip-data"]=r.toolTip}},c._createCake=function(a){var b=a.cx,c=a.cy,d=(a.dx,a.dy,a.radius),e=a.thickness,f=a["start-angle"],g=a["end-angle"],h=(a["stroke-width"],null);if(359.9<g-f)h=this._paper.circle(b,c,d-e/2).attr({stroke:this._getColor(a.fill),"stroke-width":e,"stroke-opacity":a["fill-opacity"]}),this._paper.circle(b,c,d).attr({stroke:this._getColor(a.stroke),"stroke-width":a["stroke-width"],"stroke-opacity":a["stroke-opacity"],"stroke-dasharray":a["stroke-dasharray"]}),this._paper.circle(b,c,d-e).attr({stroke:this._getColor(a.stroke),"stroke-width":a["stroke-width"],"stroke-opacity":a["stroke-opacity"],"stroke-dasharray":a["stroke-dasharray"]});else{var i=b+(d-e)*Math.sin(f/180*Math.PI),j=c-(d-e)*Math.cos(f/180*Math.PI),k=b+d*Math.sin(f/180*Math.PI),l=c-d*Math.cos(f/180*Math.PI),m=b+d*Math.sin(g/180*Math.PI),n=c-d*Math.cos(g/180*Math.PI),o=b+(d-e)*Math.sin(g/180*Math.PI),p=c-(d-e)*Math.cos(g/180*Math.PI),q=[];q[q.length]=["M",i,j],q[q.length]=["L",k,l],q[q.length]=["A",d,d,0,180<=g-f?1:0,1,m,n],q[q.length]=["L",o,p],q[q.length]=["A",d-e,d-e,1,180<=g-f?1:0,0,i,j],h=this._paper.path(q).attr({stroke:this._getColor(a.stroke),"stroke-width":a["stroke-width"],"stroke-opacity":a["stroke-opacity"],"stroke-dasharray":a["stroke-dasharray"],fill:this._getColor(a.fill),"fill-opacity":a["fill-opacity"],"stroke-linecap":"round","stroke-linejoin":"miter"})}return h},c._setPatternInfo=function(a){var b=a.dataset;if(!b)return null;for(var c=0,d=b.length;c<d;c++){for(var e=b[c].set,f=0,g=0,h=e.length;g<h;g++){var i=e[g];f+=(i.value||"0")-0}for(var j=(b[c].seriesName,Math.floor(b[c].startingAngle||a.startingAngle-0)%360),g=0,h=e.length;g<h;g++){var i=e[g],k=(i.value||"0")-0,l=k/f*360;i.startAngle=j,i.endAngle=j+=l,i.middleAngle=(i.startAngle+i.endAngle)/2,i.formatValue=this._getFormatNumber(a,k),i.percent=this._getFormatNumber(a,k/f*100)+"%"}}for(var c=0,d=b.length;c<d;c++)for(var e=b[c].set,g=0,h=e.length;g<h;g++){var i=e[g];i.toolTip=this._getToolTip(a,b[c],i)}for(var c=0,d=b.length;c<d;c++)for(var e=b[c].set,g=(b[c].seriesName,0),h=e.length;g<h;g++){var i=e[g];i.valueLabel=this._getValueLabel(a,b[c],i)}var m=a.doughnutRadius,n=Math.floor(a.doughnutThickness-0),o=Math.floor(a.doughnutPadding-0),j=Math.floor(a.startingAngle-0);if(!m){m=Number.MAX_VALUE;for(var c=0,d=b.length;c<d;c++){var e=b[c].set,p=this._calcSmartRadius(a,e,this._CONST.STYLEOBJECT.VALUELABEL);m=m<p?m:p}}var q=m/(b.length*(n+o));q=1<=q?1:q;for(var c=0,d=b.length;c<d;c++)b[c].radius=m-c*(n+o)*q,b[c].thickness=n*q}}).call(this,window);